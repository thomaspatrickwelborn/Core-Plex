function e(e){if(Array.isArray(e)||void 0===e)return e;const t=[];for(const[n,r]of Object.entries(e)){const e=n.split(" ");let s,i,a,o;1===e.length?(s=":scope",i=e[0]):e.length>1&&(s=e[0],i=e[1]),Array.isArray(r)?(a=r[0],o=r[1]):a=r;const c={type:i,path:s,listener:a,enable:!1};t.push(c)}return t}const t={depth:0,maxDepth:10};function n(e,r){const s=[],i=Object.assign({},t,r);if(i.depth++,i.depth>i.maxDepth)return s;for(const[t,r]of Object.entries(e))if(s.push(t),"object"==typeof r&&null!==r&&r!==e){const e=n(r,i);for(const n of e){let e;e="object"==typeof n?[t,...n].join("."):[t,n].join("."),s.push(e)}}return s}const r=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function s(){const e=[...arguments],t=e.shift();if(!t)return t;const n=e;if(!t)return t;for(const e of n)for(const[n,i]of Object.entries(e)){const e=r(i),a=r(t[n]);t[n]="undefined"===a?"array"===e?i:"object"===e?Object.assign({},i):i:"array"===e?i:"object"===e?s(t[n],i):i}return t}var i=Object.freeze({__proto__:null,expandEvents:e,impandEvents:function(e){if(!Array.isArray(e))return e;const t={};for(const n of e){const{path:e,type:r,listener:s,options:i}=n,a=`${$path} ${$type}`;t[a]=void 0!==i?[s,i]:s}return t},propertyDirectory:n,recursiveAssign:s,recursiveAssignConcat:function e(){const t=[...arguments],n=t.shift();if(!n)return n;const s=t;if(!n)return n;for(const t of s)for(const[s,i]of Object.entries(t)){const t=r(i),a=r(n[s]);n[s]="undefined"===a?"array"===t?Array.prototype.concat([],i):"object"===t?Object.assign({},i):i:"array"===t?n[s].concat(i):"object"===t?e(n,i):i}return n},typeOf:r}),a=Object.freeze({events:{},enableEvents:!1,propertyDefinitions:Object.freeze({getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents"})});function o(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var r=e.substr(0,t),s=e.substr(t+2);if(r.length>0&&s.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function c(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,r=0,s=0,i=-1,a=[""],l=[],p=0;p<e.length;p++){var h=e[p];if("\\"!==h){if("{"===h)if(n)r++;else if(p>i&&!r){t=e.substring(i+1,p);for(var g=0;g<a.length;g++)a[g]+=t;l=[],i=p,n=!0,r++}else r--;else if("}"===h)if(n)s++;else if(1===s){if(t=e.substring(i+1,p),l.length>0){var u=[];l.push(c(t));for(g=0;g<a.length;g++)for(var f=0;f<l.length;f++)for(var d=0;d<l[f].length;d++)u.push(a[g]+l[f][d]);a=u}else{t=o(t);for(g=0;g<a.length;g++)a[g]+=t}i=p,s--}else s--;else n||","!==h||s-r!=1||(t=e.substring(i+1,p),l.push(c(t)),i=p);!n||s!==r&&p!==e.length-1||(n=!1,p=i-1)}else p++}if(-1===i)return[e];var b="{"===e[i]?i:i+1;if(b<e.length){t=e.substr(b);for(g=0;g<a.length;g++)a[g]+=t}return a}function l(e,t){var n,r=!1!==t["!"],s=!1!==t["()"],i=!1;if(r){for(n=0;n<e.length&&"!"===e[n];n++){if(s&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function p(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function h(e,t,n){var r=void 0===t.separator||t.separator,s="",i="",a=".";!0===r?(s="/",i="[/\\\\]",a="[^/\\\\]"):a=r?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=p(e[n]);return t}(s=r)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var o=r?i+"+?":"",c=r?i+"*?":"",l=r?e.split(s):[e];return{source:e,segments:l,options:t,separator:r,separatorSplitter:s,separatorMatcher:i,optionalSeparator:c,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:r&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function g(e,t,n,r){return{source:e,isFirst:n,isLast:r,end:e.length-1}}var u="(?!\\.)";function f(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=u+t),e.dotHandled=!0,e.result.match+=t),e.result}function d(e,t,n){var r=e.support,s=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(r.excludeDot||(s.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:f(s,i);if(r.globstar&&"**"===t.source)return f(s,"(?:"+((s.dotHandled?"":u)+e.wildcard+"*?"+i)+")*?");for(;++s.i<=t.end;){if(s.char=s.segment.source[s.i],s.nextChar=s.i<t.end?t.source[s.i+1]:"","\\"===s.char){if(s.i<s.segment.end){s.escapeChar=!0;continue}s.char=""}e=s.pattern,t=s.segment;var a=s.char,o=s.i;if(e.support.brackets&&!s.scanningForParens){if(o>s.openingBracket&&o<=s.closingBracket){s.escapeChar?f(s,p(a)):o===s.closingBracket?(f(s,"]"),s.openingBracket=t.source.length):"-"===a&&o===s.closingBracket-1?f(s,"\\-"):"!"===a&&o===s.openingBracket+1?f(s,"^"):f(s,"]"===a?"\\]":a),s.escapeChar=!1;continue}if(o>s.openingBracket){"]"===a&&!s.escapeChar&&o>s.openingBracket+1&&o>s.closingBracket?(s.closingBracket=o,s.i=s.openingBracket,e.separator?f(s,"(?!"+e.separatorMatcher+")[",!0):f(s,"[",!0)):o===t.end&&(f(s,"\\["),s.i=s.openingBracket,s.openingBracket=t.source.length,s.closingBracket=t.source.length),s.escapeChar=!1;continue}if("["===a&&!s.escapeChar&&o>s.closingBracket&&o<t.end){s.openingBracket=o,s.escapeChar=!1;continue}}if(s.pattern.support.extglobs){var c=s.extglobModifiers,l=(a=s.char,s.nextChar);o=s.i;if("("!==l||s.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||s.escapeChar){if("|"===a&&s.closingParens&&!s.scanningForParens&&!s.escapeChar){f(s,"|");continue}}else if(s.scanningForParens)s.closingParens++;else if(c.length){var h=c.pop();if("!"===h&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");f(s,")"+(h="!"===h||"@"===h?"":h)),s.addToMatch=!0,s.addToUnmatch=!0,s.closingParens--;continue}}else if(s.scanningForParens)s.openingParens++;else if(o>s.parensHandledUntil&&!s.closingParens)s.parensHandledUntil=o,s.scanningForParens=!0,s.openingParens++;else{if(s.closingParens>=s.openingParens){"!"===a&&(s.addToMatch=!0,s.addToUnmatch=!1,f(s,s.pattern.wildcard+"*?",!0),s.addToMatch=!1,s.addToUnmatch=!0,s.result.useUnmatch=!0),c.push(a),f(s,"(?:",!0),s.openingParens--,s.i++;continue}s.openingParens--}if(s.scanningForParens){s.closingParens!==s.openingParens&&o!==s.segment.end||(s.scanningForParens=!1,s.i=s.parensHandledUntil-1),s.escapeChar=!1;continue}}r=(e=s.pattern).support;!s.escapeChar&&r.star&&"*"===s.char?s.i!==s.segment.end&&"*"===s.nextChar||f(s,e.wildcard+"*?",!0):!s.escapeChar&&r.qMark&&"?"===s.char?f(s,e.wildcard,!0):f(s,p(s.char)),s.escapeChar=!1}return f(s,i)}function b(e,t,n){for(var r=h(e,t,n),s={match:"",unmatch:"",useUnmatch:!1},i=r.segments,a=0;a<i.length;a++){d(r,g(i[a],0,0===a,a===i.length-1),s)}return s.useUnmatch?"(?!^"+s.unmatch+"$)"+s.match:s.match}function v(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function y(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],r=0;r<e.length;r++)for(var s=t(e[r]),i=0;i<s.length;i++)n.push(s[i]);return n}(e,c));for(var n=[],r=[],s="",i=0;i<e.length;i++){var a=l(e[i],t),o=b(a.pattern,t,!a.isNegated);a.isNegated?r.push(o):n.push(o)}return r.length&&(s="(?!(?:"+r.join("|")+")$)"),n.length>1?s+="(?:"+n.join("|")+")":1===n.length?s+=n[0]:s.length&&(s+=b("**",t,!0)),"^"+s+"$"}(e,t),r=new RegExp(n,t.flags),s=v.bind(null,r);return s.options=t,s.pattern=e,s.regexp=r,s}var m={propertyDirectory:{maxDepth:10},path:":scope",enable:!1,accessors:["[]","get"],accessors:[(e,t)=>e[t],(e,t)=>e?.get(t)],target:void 0,assign:"addEventListener",deassign:"removeEventListener",methods:{assign:{addEventListener:function(e){const{type:t,listener:n,settings:r}=this,{options:s,useCapture:i}=r;return e.addEventListener(t,n,s||i)},on:function(e){const{type:t,listener:n,settings:r}=this;return e.on(t,n)},once:function(e){const{type:t,listener:n}=this;return e.once(t,n)}},deassign:{removeEventListener:function(e){const{type:t,listener:n,settings:r}=this,{options:s,useCapture:i}=r;return e.removeEventListener(t,n,s||i)},off:function(e){const{type:t,listener:n}=this;return e.off(t,n)}}}};class E{#e;#t=!1;#n;#r;#s=[];#i=[];#a;#o=[];#c;#l;constructor(e){this.#e=Object.assign({},m,e),this.enable=this.settings.enable}get settings(){return this.#e}get path(){return this.settings.path}get type(){return this.settings.type}get listener(){return this.settings.listener}get#p(){return this.settings.context}get#h(){return this.settings.methods}get#g(){return this.settings.target}get#u(){return void 0!==this.#c||(this.#c=this.settings.methods.assign[this.settings.assign].bind(this)),this.#c}get#f(){return void 0!==this.#l||(this.#l=this.settings.methods.deassign[this.settings.deassign].bind(this)),this.#l}get#d(){const e=this.#o;let t=this.#b;const n=[],s=[],i=r(this.path);if(this.#g){const t=e.find((e=>e?.path===this.path));void 0!==t?s.push(t):void 0===t&&s.push({path:this.path,target:this.#g,enable:!1})}else if(["array","string"].includes(i)){const r=y(this.path,{separator:"."});for(const e of t){!0===r(e)&&n.push(e)}for(const t of n){const n=e.find((e=>e?.path===t));let r,i=this.#p;const a=t.split(".");let o=0;e:for(;o<a.length;){let e=a[o];if(0===o&&":scope"===e)break e;t:for(const t of this.settings.accessors){if(void 0===i)break t;if(i=t(i,e),void 0!==i)break t}o++}void 0!==i&&(r=i===n?.target?n:{path:t,target:i,enable:!1}),void 0!==r&&s.push(r)}}return this.#o=s,this.#o}get#b(){return n(this.#p,this.settings.propertyDirectory)}get enabled(){return this.#s}get disabled(){return this.#i}get enable(){return this.#t}set enable(e){this.#s.length=0,this.#i.length=0;const t=this.#d;for(const n of t){const{path:t,target:r,enable:s}=n;this.settings;if(s!==e)if(!0===e)try{this.#u(r),n.enable=e,this.#s.push(n)}catch(e){this.#i.push(n)}else if(!1===e)try{this.#f(r),n.enable=e,this.#i.push(n)}catch(e){this.#s.push(n)}}!0===e&&0===this.#i.length||!1===e&&0===this.#s.length?this.#t=e:this.#t=null}}class x extends EventTarget{static implement=function(t,n){const r=s({},a,n),i=[];return Object.defineProperties(t,{[r.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(0===arguments.length)return i;const e=[],t=[].concat(arguments[0]);for(const n of t){const{type:t,path:r,listener:s,enable:a}=n,o=[];void 0!==t&&o.push(["type",t]),void 0!==r&&o.push(["path",r]),void 0!==s&&o.push(["listener",s]),void 0!==a&&o.push(["enable",a]),e.push(...i.filter((e=>o.reduce(((t,[n,r])=>{const s=e[n]===r;return!1!==t&&(t=s),t}),void 0))))}return e}},[r.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){let n=e(arguments[0]);for(let e of n){e=s({context:t},e);const n=new E(e);i.push(n)}return t}},[r.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){let e;if(0===arguments.length?e=t[r.propertyDefinitions.getEvents]():1===arguments.length&&(e=t[r.propertyDefinitions.getEvents](arguments[0])),0===e.length)return t;let n=e.length-1;for(;n>-1;){const t=e[n];-1!==i.findIndex((e=>e===t))&&(t.enable=!1,i.splice(n,1)),n--}return t}},[r.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length||!0===arguments[0]?i:t[r.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!0;return t}},[r.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length?i:t[r.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!1;return t}},[r.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){return t[r.propertyDefinitions.disableEvents](...arguments),t[r.propertyDefinitions.enableEvents](...arguments),t}}}),r.events&&t[r.propertyDefinitions.addEvents](r.events),r.enableEvents&&t[r.propertyDefinitions.enableEvents](r.enableEvents),t};constructor(e={}){return super(),x.implement(this,e)}}export{x as Core,i as Coutil};
//# sourceMappingURL=core-plex.min.js.map
