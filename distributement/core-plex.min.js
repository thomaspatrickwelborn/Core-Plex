function e(e){if(Array.isArray(e)||void 0===e)return e;const t=[];for(const[n,s]of Object.entries(e)){const e=n.split(" ");let r,i,a,o;1===e.length?(r=":scope",i=e[0]):e.length>1&&(r=e[0],i=e[1]),Array.isArray(s)?(a=s[0],o=s[1]):a=s;const c={type:i,path:r,listener:a,enable:!1};t.push(c)}return t}const t={depth:0,maxDepth:10};function n(e,s){const r=[],i=Object.assign({},t,s);if(i.depth++,i.depth>i.maxDepth)return r;for(const[t,s]of Object.entries(e))if(r.push(t),"object"==typeof s&&null!==s&&s!==e){const e=n(s,i);for(const n of e){let e;e="object"==typeof n?[t,...n].join("."):[t,n].join("."),r.push(e)}}return r}const s=e=>Object.prototype.toString.call(e).slice(8,-1).toLowerCase();function r(){const e=[...arguments],t=e.shift();if(!t)return t;const n=e;if(!t)return t;for(const e of n)if(e)for(const[n,i]of Object.entries(e)){const e=s(i),a=s(t[n]);t[n]="undefined"===a?"array"===e?i:"object"===e?Object.assign({},i):i:"array"===e?i:"object"===e?r(t[n],i):i}return t}var i=Object.freeze({__proto__:null,expandEvents:e,impandEvents:function(e){if(!Array.isArray(e))return e;const t={};for(const n of e){const{path:e,type:s,listener:r,options:i}=n,a=`${$path} ${$type}`;t[a]=void 0!==i?[r,i]:r}return t},propertyDirectory:n,recursiveAssign:r,recursiveAssignConcat:function e(){const t=[...arguments],n=t.shift();if(!n)return n;const r=t;if(!n)return n;for(const t of r)for(const[r,i]of Object.entries(t)){const t=s(i),a=s(n[r]);n[r]="undefined"===a?"array"===t?Array.prototype.concat([],i):"object"===t?Object.assign({},i):i:"array"===t?n[r].concat(i):"object"===t?e(n,i):i}return n},recursiveFreeze:function e(t){for(const[n,s]of Object.entries(t))s&&"object"==typeof s&&e(s);return Object.freeze(t)},typeOf:s});function a(e){if(e.length<3)return"{"+e+"}";for(var t=-1,n=2;n<e.length;n++)if("."===e[n]&&"."===e[n-1]&&(n<2||"\\"!==e[n-2])){if(t>-1)return"{"+e+"}";t=n-1}if(t>-1){var s=e.substr(0,t),r=e.substr(t+2);if(s.length>0&&r.length>0)return"["+e.substr(0,t)+"-"+e.substr(t+2)+"]"}return"{"+e+"}"}function o(e){if("string"!=typeof e)throw new TypeError("A pattern must be a string, but "+typeof e+" given");for(var t,n=!1,s=0,r=0,i=-1,c=[""],g=[],l=0;l<e.length;l++){var h=e[l];if("\\"!==h){if("{"===h)if(n)s++;else if(l>i&&!s){t=e.substring(i+1,l);for(var p=0;p<c.length;p++)c[p]+=t;g=[],i=l,n=!0,s++}else s--;else if("}"===h)if(n)r++;else if(1===r){if(t=e.substring(i+1,l),g.length>0){var u=[];g.push(o(t));for(p=0;p<c.length;p++)for(var f=0;f<g.length;f++)for(var d=0;d<g[f].length;d++)u.push(c[p]+g[f][d]);c=u}else{t=a(t);for(p=0;p<c.length;p++)c[p]+=t}i=l,r--}else r--;else n||","!==h||r-s!=1||(t=e.substring(i+1,l),g.push(o(t)),i=l);!n||r!==s&&l!==e.length-1||(n=!1,l=i-1)}else l++}if(-1===i)return[e];var b="{"===e[i]?i:i+1;if(b<e.length){t=e.substr(b);for(p=0;p<c.length;p++)c[p]+=t}return c}function c(e,t){var n,s=!1!==t["!"],r=!1!==t["()"],i=!1;if(s){for(n=0;n<e.length&&"!"===e[n];n++){if(r&&"("===e[n+1]){n--;break}i=!i}n>0&&(e=e.substr(n))}return{pattern:e,isNegated:i}}function g(e){return"-"===e||"^"===e||"$"===e||"+"===e||"."===e||"("===e||")"===e||"|"===e||"["===e||"]"===e||"{"===e||"}"===e||"*"===e||"?"===e||"\\"===e?"\\"+e:e}function l(e,t,n){var s=void 0===t.separator||t.separator,r="",i="",a=".";!0===s?(r="/",i="[/\\\\]",a="[^/\\\\]"):a=s?(i=function(e){for(var t="",n=0;n<e.length;n++)t+=g(e[n]);return t}(r=s)).length>1?"((?!"+(i="(?:"+i+")")+").)":"[^"+i+"]":".";var o=s?i+"+?":"",c=s?i+"*?":"",l=s?e.split(r):[e];return{source:e,segments:l,options:t,separator:s,separatorSplitter:r,separatorMatcher:i,optionalSeparator:c,requiredSeparator:o,wildcard:a,support:{qMark:!1!==t["?"],star:!1!==t["*"],globstar:s&&!1!==t["**"],brackets:!1!==t["[]"],extglobs:!1!==t["()"],excludeDot:n&&!1!==t.excludeDot}}}function h(e,t,n,s){return{source:e,isFirst:n,isLast:s,end:e.length-1}}var p="(?!\\.)";function u(e,t,n){return e.addToUnmatch&&(e.result.unmatch+=t),e.addToMatch&&(n&&!e.dotHandled&&(t=p+t),e.dotHandled=!0,e.result.match+=t),e.result}function f(e,t,n){var s=e.support,r=function(e,t,n){return{pattern:e,segment:t,result:n,openingBracket:t.end+1,closingBracket:-1,openingParens:0,closingParens:0,parensHandledUntil:-1,extglobModifiers:[],scanningForParens:!1,escapeChar:!1,addToMatch:!0,addToUnmatch:e.support.extglobs,dotHandled:!1,i:-1,char:"",nextChar:""}}(e,t,n),i=t.isLast?e.optionalSeparator:e.requiredSeparator;if(s.excludeDot||(r.dotHandled=!0),-1===t.end)return t.isLast&&!t.isFirst?n:u(r,i);if(s.globstar&&"**"===t.source)return u(r,"(?:"+((r.dotHandled?"":p)+e.wildcard+"*?"+i)+")*?");for(;++r.i<=t.end;){if(r.char=r.segment.source[r.i],r.nextChar=r.i<t.end?t.source[r.i+1]:"","\\"===r.char){if(r.i<r.segment.end){r.escapeChar=!0;continue}r.char=""}e=r.pattern,t=r.segment;var a=r.char,o=r.i;if(e.support.brackets&&!r.scanningForParens){if(o>r.openingBracket&&o<=r.closingBracket){r.escapeChar?u(r,g(a)):o===r.closingBracket?(u(r,"]"),r.openingBracket=t.source.length):"-"===a&&o===r.closingBracket-1?u(r,"\\-"):"!"===a&&o===r.openingBracket+1?u(r,"^"):u(r,"]"===a?"\\]":a),r.escapeChar=!1;continue}if(o>r.openingBracket){"]"===a&&!r.escapeChar&&o>r.openingBracket+1&&o>r.closingBracket?(r.closingBracket=o,r.i=r.openingBracket,e.separator?u(r,"(?!"+e.separatorMatcher+")[",!0):u(r,"[",!0)):o===t.end&&(u(r,"\\["),r.i=r.openingBracket,r.openingBracket=t.source.length,r.closingBracket=t.source.length),r.escapeChar=!1;continue}if("["===a&&!r.escapeChar&&o>r.closingBracket&&o<t.end){r.openingBracket=o,r.escapeChar=!1;continue}}if(r.pattern.support.extglobs){var c=r.extglobModifiers,l=(a=r.char,r.nextChar);o=r.i;if("("!==l||r.escapeChar||"@"!==a&&"?"!==a&&"*"!==a&&"+"!==a&&"!"!==a){if(")"!==a||r.escapeChar){if("|"===a&&r.closingParens&&!r.scanningForParens&&!r.escapeChar){u(r,"|");continue}}else if(r.scanningForParens)r.closingParens++;else if(c.length){var h=c.pop();if("!"===h&&-1!==c.indexOf("!"))throw new Error("Nested negated extglobs aren't supported");u(r,")"+(h="!"===h||"@"===h?"":h)),r.addToMatch=!0,r.addToUnmatch=!0,r.closingParens--;continue}}else if(r.scanningForParens)r.openingParens++;else if(o>r.parensHandledUntil&&!r.closingParens)r.parensHandledUntil=o,r.scanningForParens=!0,r.openingParens++;else{if(r.closingParens>=r.openingParens){"!"===a&&(r.addToMatch=!0,r.addToUnmatch=!1,u(r,r.pattern.wildcard+"*?",!0),r.addToMatch=!1,r.addToUnmatch=!0,r.result.useUnmatch=!0),c.push(a),u(r,"(?:",!0),r.openingParens--,r.i++;continue}r.openingParens--}if(r.scanningForParens){r.closingParens!==r.openingParens&&o!==r.segment.end||(r.scanningForParens=!1,r.i=r.parensHandledUntil-1),r.escapeChar=!1;continue}}s=(e=r.pattern).support;!r.escapeChar&&s.star&&"*"===r.char?r.i!==r.segment.end&&"*"===r.nextChar||u(r,e.wildcard+"*?",!0):!r.escapeChar&&s.qMark&&"?"===r.char?u(r,e.wildcard,!0):u(r,g(r.char)),r.escapeChar=!1}return u(r,i)}function d(e,t,n){for(var s=l(e,t,n),r={match:"",unmatch:"",useUnmatch:!1},i=s.segments,a=0;a<i.length;a++){f(s,h(i[a],0,0===a,a===i.length-1),r)}return r.useUnmatch?"(?!^"+r.unmatch+"$)"+r.match:r.match}function b(e,t){if("string"!=typeof t)throw new TypeError("Sample must be a string, but "+typeof t+" given");return e.test(t)}function v(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("The first argument must be a single pattern string or an array of patterns, but "+typeof e+" given");if("string"!=typeof t&&"boolean"!=typeof t||(t={separator:t}),2===arguments.length&&void 0!==t&&("object"!=typeof t||null===t||Array.isArray(t)))throw new TypeError("The second argument must be an options object or a string/boolean separator, but "+typeof t+" given");if("\\"===(t=t||{}).separator)throw new Error("\\ is not a valid separator");var n=function(e,t){e=Array.isArray(e)?e:[e],!1!==t["{}"]&&(e=function(e,t){for(var n=[],s=0;s<e.length;s++)for(var r=t(e[s]),i=0;i<r.length;i++)n.push(r[i]);return n}(e,o));for(var n=[],s=[],r="",i=0;i<e.length;i++){var a=c(e[i],t),g=d(a.pattern,t,!a.isNegated);a.isNegated?s.push(g):n.push(g)}return s.length&&(r="(?!(?:"+s.join("|")+")$)"),n.length>1?r+="(?:"+n.join("|")+")":1===n.length?r+=n[0]:r.length&&(r+=d("**",t,!0)),"^"+r+"$"}(e,t),s=new RegExp(n,t.flags),r=b.bind(null,s);return r.options=t,r.pattern=e,r.regexp=s,r}var y=(e={})=>{const t={propertyDirectory:{maxDepth:10},enable:!1,accessors:[(e,t)=>e[t],(e,t)=>e?.get(t)],methods:{assign:{addEventListener:function(e){const{type:t,listener:n,settings:s}=this,{options:r,useCapture:i}=s;return e.addEventListener(t,n,r||i)},on:function(e){const{type:t,listener:n,settings:s}=this;return e.on(t,n)},once:function(e){const{type:t,listener:n}=this;return e.once(t,n)}},deassign:{removeEventListener:function(e){const{type:t,listener:n,settings:s}=this,{options:r,useCapture:i}=s;return e.removeEventListener(t,n,r||i)},off:function(e){const{type:t,listener:n}=this;return e.off(t,n)}},transsign:{dispatchEvent:function(e,t){return e.dispatchEvent(t)},emit:function(e,...t){return e.emit(t)},send:function(e,t){return e.send(t)}}}};for(const[n,s]of Object.entries(e))switch(n){case"propertyDirectory":t[n]=Object.assign(t[n],s);break;case"accessors":t[n]=t[n].concat(s);break;case"methods":t[n]=r(t[n],s);break;case"type":case"path":case"enable":case"target":case"listener":case"assign":case"deassign":case"transsign":t[n]=s}return t};class m{#e;#t;#n=!1;#s;#r;#i=[];#a=[];#o;#c=[];#g;#l;#h;constructor(e,t){this.#e=y(e),this.#t=t,this.enable=this.settings.enable}get settings(){return this.#e}get path(){return this.settings.path}get type(){return this.settings.type}get listener(){return this.settings.listener}get#p(){return this.settings.target}get#u(){const e=this.#c;let t=this.#f;const n=[],r=[],i=s(this.path);if(void 0!==this.#p)for(const t of[].concat(this.#p)){const n=e.find((e=>e?.path===this.path));void 0!==n?r.push(n):void 0===n&&r.push({path:this.path,target:t,enable:!1})}else if(["array","string"].includes(i)){const s=v(this.path,{separator:"."});for(const e of t){!0===s(e)&&n.push(e)}for(const t of n){const n=e.find((e=>e?.path===t));let s,i=this.#t;const a=t.split(".");let o=0;e:for(;o<a.length;){let e=a[o];if(0===o&&":scope"===e)break e;t:for(const t of this.settings.accessors){if(void 0===i)break t;if(i=t(i,e),void 0!==i)break t}o++}void 0!==i&&(s=i===n?.target?n:{path:t,target:i,enable:!1}),void 0!==s&&r.push(s)}}return this.#c=r,this.#c}get#d(){return void 0!==this.#g||(this.#g=this.settings.methods.assign[this.settings.assign].bind(this)),this.#g}get#b(){return void 0!==this.#l||(this.#l=this.settings.methods.deassign[this.settings.deassign].bind(this)),this.#l}get#v(){return void 0!==this.#h||(this.#h=this.settings.methods.transsign[this.settings.transsign].bind(this)),this.#h}get#y(){return this.settings.methods}get#f(){return n(this.#t,this.settings.propertyDirectory)}get enabled(){return this.#i}get disabled(){return this.#a}get enable(){return this.#n}set enable(e){const t=this.#u;if(0===t.length||e===this.enable)return;const n=this.#i,s=this.#a;n.length=0,s.length=0;for(const r of t){const{path:t,target:i,enable:a}=r;this.settings;if(a!==e)if(!0===e)try{this.#d(i),r.enable=e,n.push(r)}catch(e){throw e}else if(!1===e)try{this.#b(i),r.enable=e,s.push(r)}catch(e){n.push(r)}}!0===e&&0===s.length&&n.length>0||!1===e&&0===n.length&&s.length>0?this.#n=e:(0===s.length&&0===n.length||s.length>0&&n.length>0)&&(this.#n=null)}emit(){const e=this.#u;for(const t of e){const{target:e}=t;this.#v(e,...arguments)}return this}}class E extends EventTarget{static implement=function(t,n){const s=((e={})=>{const t={events:{},enableEvents:!1,propertyDefinitions:{getEvents:"getEvents",addEvents:"addEvents",removeEvents:"removeEvents",enableEvents:"enableEvents",disableEvents:"disableEvents",reenableEvents:"reenableEvents"},assign:"addEventListener",deassign:"removeEventListener",transsign:"dispatchEvent"};for(const[n,s]of Object.entries(e))switch(n){case"enableEvents":case"assign":case"deassign":case"transsign":case"events":t[n]=s;break;case"propertyDefinitions":t[n]=Object.assign(t[n],s)}return t})(n),r=[];return Object.defineProperties(t,{[s.propertyDefinitions.getEvents]:{enumerable:!1,writable:!1,value:function(){if(0===arguments.length)return r;const e=[],t=[].concat(arguments[0]);for(const n of t){const t=[];for(const[e,s]of Object.entries(n))t.push([e,s]);for(const n of r){let s;e:for(const[e,r]of t){const t=n[e]===r;if(!1===s)break e;s=t}!0===s&&e.push(n)}}return e}},[s.propertyDefinitions.addEvents]:{enumerable:!1,writable:!1,value:function(){let n=e(arguments[0]);for(let e of n){const n=Object.assign({assign:s.assign,deassign:s.deassign,transsign:s.transsign},e),i=new m(n,t);r.push(i)}return t}},[s.propertyDefinitions.removeEvents]:{enumerable:!1,writable:!1,value:function(){let e;if(0===arguments.length?e=t[s.propertyDefinitions.getEvents]():1===arguments.length&&(e=t[s.propertyDefinitions.getEvents](arguments[0])),0===e.length)return t;let n=e.length-1;for(;n>-1;){const t=e[n];-1!==r.findIndex((e=>e===t))&&(t.enable=!1,r.splice(n,1)),n--}return t}},[s.propertyDefinitions.enableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length||!0===arguments[0]?r:t[s.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!0;return t}},[s.propertyDefinitions.disableEvents]:{enumerable:!1,writable:!1,value:function(){let e;e=0===arguments.length?r:t[s.propertyDefinitions.getEvents](arguments[0]);for(const t of e)t.enable=!1;return t}},[s.propertyDefinitions.reenableEvents]:{enumerable:!1,writable:!1,value:function(){return t[s.propertyDefinitions.disableEvents](...arguments),t[s.propertyDefinitions.enableEvents](...arguments),t}}}),s.events&&t[s.propertyDefinitions.addEvents](s.events),s.enableEvents&&t[s.propertyDefinitions.enableEvents](s.enableEvents),t};constructor(e={}){return super(),E.implement(this,e)}}export{E as Core,i as Coutil};
//# sourceMappingURL=core-plex.min.js.map
